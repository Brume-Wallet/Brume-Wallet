on:
  push:
    tags:
    - '*'

name: release

jobs:
  check:
    name: check
    runs-on: ubuntu-22.04
    steps:
    - uses: actions/checkout@v3
    - uses: actions/setup-node@v3
      with:
        node-version: 20.x
    - run: "npm ci"
    - run: "npm run build"
    - run: "wget https://github.com/brumewallet/wallet/releases/download/${{github.ref_name}}/chrome.zip && unzip chrome.zip -d ./chrome"
    - run: "wget https://github.com/brumewallet/wallet/releases/download/${{github.ref_name}}/firefox.zip && unzip firefox.zip -d ./firefox"
    - run: "wget https://github.com/brumewallet/wallet/releases/download/${{github.ref_name}}/safari.zip && unzip safari.zip -d ./safari"
    - run: "wget https://github.com/brumewallet/wallet/releases/download/${{github.ref_name}}/website.zip && unzip website.zip -d ./website"
    - run: "(diff -r ./dist/chrome ./chrome) && (diff -r ./dist/firefox ./firefox) && (diff -r ./dist/firefox ./firefox) && (diff -r ./dist/website ./website)"